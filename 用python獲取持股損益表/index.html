<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="Cache-control" content="public">
    <meta http-equiv="Cache-Control" content="max-age=604800">
    
    <title>自動下單（1）用Python爬取交易記錄 | FinLab 量化實驗室</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
        <meta name="keywords" content="python,程式設計,爬蟲">
    
    <meta name="description" content="量化投資原來分為以下兩個步驟：  用數學模型，運算出買賣股票清單 清單自動與看盤軟體對接，實現自動買賣  今天就教你怎麼將自己的帳戶與python做連接，讓電腦得知你實際持股的部位。   打開券商看盤軟體（網站）首先，我們針對新光證券來進行對接，其它證券的朋友就不好意思了，我只有新光XDD，但每一家的網站設計不會差太多，可以舉一反三，做出其它證券的對接系統。 雖然我是新光的用戶，但新光的網站真的很">
<meta name="keywords" content="python,程式設計,爬蟲">
<meta property="og:type" content="article">
<meta property="og:title" content="自動下單（1）用Python爬取交易記錄">
<meta property="og:url" content="https://www.finlab.tw/用python獲取持股損益表/index.html">
<meta property="og:site_name" content="FinLab 量化實驗室">
<meta property="og:description" content="量化投資原來分為以下兩個步驟：  用數學模型，運算出買賣股票清單 清單自動與看盤軟體對接，實現自動買賣  今天就教你怎麼將自己的帳戶與python做連接，讓電腦得知你實際持股的部位。   打開券商看盤軟體（網站）首先，我們針對新光證券來進行對接，其它證券的朋友就不好意思了，我只有新光XDD，但每一家的網站設計不會差太多，可以舉一反三，做出其它證券的對接系統。 雖然我是新光的用戶，但新光的網站真的很">
<meta property="og:locale" content="zh-TW">
<meta property="og:image" content="https://www.finlab.tw/用python獲取持股損益表/thumbnail.jpeg">
<meta property="og:updated_time" content="2018-01-24T11:42:27.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="自動下單（1）用Python爬取交易記錄">
<meta name="twitter:description" content="量化投資原來分為以下兩個步驟：  用數學模型，運算出買賣股票清單 清單自動與看盤軟體對接，實現自動買賣  今天就教你怎麼將自己的帳戶與python做連接，讓電腦得知你實際持股的部位。   打開券商看盤軟體（網站）首先，我們針對新光證券來進行對接，其它證券的朋友就不好意思了，我只有新光XDD，但每一家的網站設計不會差太多，可以舉一反三，做出其它證券的對接系統。 雖然我是新光的用戶，但新光的網站真的很">
<meta name="twitter:image" content="https://www.finlab.tw/用python獲取持股損益表/thumbnail.jpeg">
    

    
        <link rel="alternate" href="/atom.xml" title="FinLab 量化實驗室" type="application/atom+xml">
    

    
        <link rel="icon" href="/css/images/favicon.png# path to favicon">
    


    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/titillium-web/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.0.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
        <script type="text/javascript">
(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-106968614-1', 'auto');
ga('send', 'pageview');

</script>
    
    


</head>
</html>
<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" class="logo"></a>
                    </h1>
                    
                        <h2 class="subtitle-wrap">
                            <p class="subtitle">用統計、回測的方式教你如何買股票</p>
                        </h2>
                    
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item">
                                    <a class="main-nav-list-link" href="/">首頁</a>
                                </li>
                            
                                        <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/AI看股票/">AI看股票</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/大盤漲跌/">大盤漲跌</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/指標分析/">指標分析</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/指標分析/基本面/">基本面</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/指標分析/技術面/">技術面</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/指標分析/籌碼面/">籌碼面</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/財報狗分析/">財報狗分析</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/財經Python教學/">財經Python教學</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/選股策略/">選股策略</a></li></ul>
                                    
                                <li class="main-nav-list-item">
                                    <a class="main-nav-list-link" href="/關於/index.html">關於</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜尋">
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="輸入關鍵字(股票,量化...)">
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '頁面',
            CATEGORIES: '分類',
            TAGS: '標籤',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    <a class="page-title-link" href="/categories/財經Python教學/">財經Python教學</a>
    </h1>
</div>
                        <div class="main-body-content">
                            <style>
        .css-input-sub { margin-left: 20%;padding-left:10px;height: 40px; width: 60%; font-size:12px; text-align:left; border-style:solid; border-color:#006bde; text-shadow:0px 0px 0px rgba(42,42,42,.75); box-shadow: 0px 0px 42px 0px rgba(0,0,0,0.2); border-radius:3px; background-color:rgba(0,0,0,0); color: #006bde; border-width: 0; } 
        .css-input-sub:focus { outline: none } 
        .btn {
            width: calc(15% - 20px);
            height: 40px;
            font-size: 14px;
            border-radius:3px;
            box-shadow: 0px 0px 42px 0px rgba(0,0,0,0.2);
            border: 0;
            color: white;
            background-color: #006bde;
            margin-left: 10px;
        }
        .btn:hover {
            cursor: pointer;
        }
        .btn:focus { outline: none; }
</style>
<article id="post-用python獲取持股損益表" class="article article-single article-type-post" itemscope="" itemprop="blogPost">
    <div class="article-inner">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        自動下單（1）用Python爬取交易記錄
        </h1>
    

            </header>
        

        
            <div class="article-meta">
                
    <div class="article-date">
        <a href="/用python獲取持股損益表/" class="article-date">
            <time datetime="2018-01-08T14:07:16.000Z" itemprop="datePublished">2018-01-08</time>
        </a>
    </div>

                
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/python/">python</a>, <a class="tag-link" href="/tags/爬蟲/">爬蟲</a>, <a class="tag-link" href="/tags/程式設計/">程式設計</a>
    </div>

            </div>
        
        
        <div class="article-entry" itemprop="articleBody">
            <p>量化投資原來分為以下兩個步驟：</p>
<ol>
<li>用數學模型，運算出買賣股票清單</li>
<li>清單自動與看盤軟體對接，實現自動買賣</li>
</ol>
<p>今天就教你怎麼將自己的帳戶與python做連接，讓電腦得知你實際持股的部位。</p>
<center><img src="/用python獲取持股損益表/thumbnail.jpeg" alt="連接帳戶" title="連接帳戶"></center>

<h3 id="打開券商看盤軟體（網站）"><a href="#打開券商看盤軟體（網站）" class="headerlink" title="打開券商看盤軟體（網站）"></a>打開券商看盤軟體（網站）</h3><p>首先，我們針對新光證券來進行對接，其它證券的朋友就不好意思了，我只有新光XDD，但每一家的網站設計不會差太多，可以舉一反三，做出其它證券的對接系統。</p>
<p>雖然我是新光的用戶，但新光的網站真的很瞎！介面老舊不說，每天早上9點開盤必當機…好在我都是直接下開盤漲停買入，我是可憐窮散戶金額小所以沒差XDD。</p>
<h3 id="打開網頁，監控network"><a href="#打開網頁，監控network" class="headerlink" title="打開網頁，監控network"></a>打開網頁，監控network</h3><p>接下來我們要來查看登入機制是如何運作的，知道了內部的機制，才能用python來模擬登入的動作喔！</p>
<ol>
<li>用無痕視窗<a href="https://w.sk88.com.tw/Cross/Pc/Login.aspx" rel="external nofollow noopener noreferrer" target="_blank">登入頁面</a></li>
<li>對著網頁任何一處按右鍵，選擇inspect（中文忘記是什麼了，反正就是最下方那個XD）</li>
<li>選擇network（一樣請自己對照中文）</li>
</ol>
<p>做完這三步驟你應該會看到以下節圖：</p>
<center><img src="/用python獲取持股損益表/1.png" alt="螢幕節圖" title="螢幕節圖"></center>

<h1 id="這個-Network-列表是做什麼的？"><a href="#這個-Network-列表是做什麼的？" class="headerlink" title="這個 Network 列表是做什麼的？"></a>這個 Network 列表是做什麼的？</h1><p>network這個列表，最主要就是會紀錄網頁所用到的 get 跟 post 的請求，什麼是 get 跟 post 呢？籠統的說，這些就是你的瀏覽器跟網站主機互動時的通信方式，平常瀏覽網頁，將網頁從網路上下載到瀏覽器中，這個動作通常是用get，而隱私性比較高的（登入、修改網路上的資料），就會用 post。</p>
<p>輸入你的帳號密碼按下登入，你會看到network的列表出現了很多東西，大部分的都不重要，請點選其中的 Login.aspx，裡面紀錄著用來登入的通訊過程。</p>
<center><img src="/用python獲取持股損益表/2.png" alt="螢幕節圖" title="螢幕節圖"></center>

<p>你應該會看到以上的節圖，裡面有些重要的資訊，我們先把登入當作是一封寫給新光主機的信，上圖中包含了幾個重要的資訊：</p>
<ol>
<li>信寄到：<a href="https://w.sk88.com.tw/Cross/Pc/Login.aspx" rel="external nofollow noopener noreferrer" target="_blank">https://w.sk88.com.tw/Cross/Pc/Login.aspx</a> 這個地方</li>
<li>這是一個 POST request</li>
<li>server 回覆代號是 302 （通常是2XX、或3XX。4XX、5XX代表有問題）</li>
</ol>
<h3 id="查看-Request-內容"><a href="#查看-Request-內容" class="headerlink" title="查看 Request 內容"></a>查看 Request 內容</h3><p>目前知道的訊息有：信的種類為 post，而地址也有了。但信中的內容要寫什麼呢？無非就是跟登入有關的訊息吧！例如帳號密碼之類的，所以我們將視窗往下拉，看到form data這裡：</p>
<center><img src="/用python獲取持股損益表/3.png" alt="螢幕節圖" title="螢幕節圖"></center>

<p>你可以看到信封裡的內容：</p>
<ol>
<li>__EVENTTARGET: 欄位為空</li>
<li>__EVENTARGUMENT: 欄位為空</li>
<li>__VIEWSTATE: 亂碼</li>
<li>__VIEWSTATEGENERATOR: 亂碼</li>
<li>__EVENTVALIDATION: 亂碼</li>
<li>TxtIDNo: 你的身份證字號,</li>
<li>TxtPass: 你的密碼,</li>
<li>HiddenIDNo: 你的生份正字號,</li>
<li>Button1: 登入,</li>
</ol>
<p>我們可以發現除了帳號密碼外，還有很多怪東西，例如：「__EVENTTARGET」等等，這些東西我們不能亂填，我們得找到這些欄位的正確內容，登入才會生效。<br>我們可以到原本的登入網頁找：</p>
<ol>
<li>回到登入頁面（inspect依然開啟）</li>
<li>點選 inspect 中的 Element，打開網站的原始碼，並搜尋（Ctrl-F 或 Cmd-F），’__VIEWSTATE’，就可以找到一它的value是多少了！</li>
<li>其它如「<code>__EVENTARGUMENT</code>」、「<code>__VIEWSTATE</code>」、「<code>__VIEWSTATEGENERATOR</code>」、「<code>__EVENTVALIDATION</code>」也是用一樣的方式找</li>
</ol>
<p>以下是節圖：</p>
<center><img src="/用python獲取持股損益表/4.png" alt="螢幕節圖" title="螢幕節圖"></center>

<p>當然自己慢慢輸入肯定很蠢，所以這一切都要用python自動化才行！<br>以後真的只要1秒就可以下載好，省去網站慢吞吞填入帳密。。。</p>
<h3 id="寫code時間"><a href="#寫code時間" class="headerlink" title="寫code時間"></a>寫code時間</h3><p>所以你已經瞭解了原理了，接下來就是實做！<br>首先，我們要得到網頁，找尋當中的「__VIEWSTATE」等驗證碼：<br><figure class="highlight python"><figcaption><span>得到網頁、驗證碼</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">from</span> io <span class="keyword">import</span> StringIO</div><div class="line"></div><div class="line"><span class="comment"># 開啟瀏覽器</span></div><div class="line">ses = requests.Session()</div><div class="line"></div><div class="line"><span class="comment"># 打開登入網頁</span></div><div class="line">d = ses.get(<span class="string">'https://w.sk88.com.tw/Cross/Pc/Login.aspx'</span>)</div><div class="line"></div><div class="line"><span class="comment"># 此函式會找特定的value，如「__VIEWSTATE」等</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_value</span><span class="params">(name, web)</span>:</span></div><div class="line">    reg = <span class="string">'name="'</span> + name + <span class="string">'".+value="(.*)" /&gt;'</span></div><div class="line">    pattern = re.compile(reg)</div><div class="line">    result  = pattern.findall(web.text)</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        <span class="keyword">return</span> result[<span class="number">0</span>]</div><div class="line">    <span class="keyword">except</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">""</span></div><div class="line"></div><div class="line"><span class="comment"># 使用方式</span></div><div class="line">find_value(<span class="string">'__VIEWSTATE'</span>, d)</div><div class="line"></div></pre></td></tr></table></figure></p>
<p>我特別寫好了一個 <code>find_value</code> 的函式，它會幫你找出網頁中的怪碼，大家有興趣可以去研究 <a href="http://webber-pypyso.blogspot.fr/2011/02/10-1-1.html" rel="external nofollow noopener noreferrer" target="_blank">regex</a> ，用來解析字串用的。</p>
<center><img src="/用python獲取持股損益表/find_value.png" alt="find_value的用法" title="find_value的用法"></center>

<p>於是<code>__VIEWSTATEGENERATOR</code>、  <code>__EVENTVALIDATION</code>，這些怪東西的驗證碼就被找到了！</p>
<h3 id="寫信封的內容"><a href="#寫信封的內容" class="headerlink" title="寫信封的內容"></a>寫信封的內容</h3><p>接下來我們再來實際的登入：</p>
<figure class="highlight python"><figcaption><span>用python模擬登入</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">data = &#123;</div><div class="line">    <span class="string">'__EVENTTARGET'</span>: find_value(<span class="string">'__EVENTTARGET'</span>, d),</div><div class="line">    <span class="string">'__EVENTARGUMENT'</span>: find_value(<span class="string">'__EVENTARGUMENT'</span>, d),</div><div class="line">    <span class="string">'__VIEWSTATE'</span>: find_value(<span class="string">'__VIEWSTATE'</span>, d),</div><div class="line">    <span class="string">'__VIEWSTATEGENERATOR'</span>: find_value(<span class="string">'__VIEWSTATEGENERATOR'</span>, d),</div><div class="line">    <span class="string">'__EVENTVALIDATION'</span>: find_value(<span class="string">'__EVENTVALIDATION'</span>, d),</div><div class="line">    <span class="string">'TxtIDNo'</span>:<span class="string">'你的身份證字號（帳號）'</span>,</div><div class="line">    <span class="string">'TxtPass'</span>:<span class="string">'密碼'</span>,</div><div class="line">    <span class="string">'HiddenIDNo'</span>:<span class="string">'你的身份證字號（帳號）'</span>,</div><div class="line">    <span class="string">'Button1'</span>:<span class="string">'登入'</span>,</div><div class="line">&#125;</div><div class="line"></div><div class="line">login = ses.post(<span class="string">'https://w.sk88.com.tw/Cross/Pc/Login.aspx'</span>, data=data)</div></pre></td></tr></table></figure>
<p>以上的code，就是創建信封的內容 data，並發送「POST」，請求登入。記得要修改改帳號密碼才能用喔！</p>
<h3 id="下載持股部位"><a href="#下載持股部位" class="headerlink" title="下載持股部位"></a>下載持股部位</h3><p>接下來，由於已經登入了，我們就去相對應的網址，下載自己的持股部位：<br><figure class="highlight python"><figcaption><span>下載持股部位</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment"># 下載持股</span></div><div class="line">data = ses.get(<span class="string">'https://w.sk88.com.tw/Cross/Pc/QueryPositionRealTime.aspx'</span>)</div><div class="line">data.encoding = <span class="string">'utf-8'</span></div><div class="line"></div><div class="line"><span class="comment"># 用 pandas 整理</span></div><div class="line">df = pd.read_html(StringIO(data.text))[<span class="number">0</span>]</div><div class="line"></div><div class="line"><span class="comment"># 設定第一行row 為 欄位名稱</span></div><div class="line">df.columns = df.iloc[<span class="number">0</span>]</div><div class="line"></div><div class="line"><span class="comment"># 刪除第一行row</span></div><div class="line">df = df.iloc[<span class="number">1</span>:]</div><div class="line">df</div></pre></td></tr></table></figure></p>
<center><img src="/用python獲取持股損益表/df.png" alt="持股記錄" title="持股記錄"></center>

<p>以上是我的持股記錄，趁最近表現不錯放一下XDD，這只是表面績效很好，實際上沒那麼好，因為最近賣了很多虧損股，只剩好的股票，所以才看起來光鮮亮麗。絕對不能只看持股獲利，還必須考慮銀行帳戶中的存款才行喔！不然很有可能發現，持股獲利很高，但帳戶餘額慢慢變少的情況喔！</p>
<p>以上就是今天的教學，有以下幾個小重點：</p>
<ol>
<li>學習用chrome來找 get post 的方法</li>
<li>利用python 模擬登入帳號</li>
<li>下載自己的持股狀況</li>
</ol>
<p>下次會介紹如何串接自動化買賣，敬請期待！</p>


            
            <!-- Begin MailChimp Signup Form -->
            <link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
            <style type="text/css">
                #mc_embed_signup{text-align: left;background:#fff; clear:left; width:100%;margin: 0}
                #mc_embed_signup form {text-align:left;}
                /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
                We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
            </style>

            
                <!--<div style="text-align: center;background-color: white;">
                    <div style="margin: auto;height:75px;width:75px;background: url('/images/authors/韓承佑.jpg');background-size: 100%;border-radius: 37px"></div>
                    <a href="mailto:koreal6803@gmail.com"><p style="font-size: 90%;margin:0;margin-top: 1em;color: black">韓承佑</p></a>
                    <p style="font-size: 80%;margin:0">FinLab博主</p>
                </div>-->
            
            <!--End mc_embed_signup  
-->

            <div><h3 class="article-title">相關文章</h3>
            <ul class="popular-posts"><div><div style="margin-right:20px;background: url('/超簡單用python抓取每月營收/table.png') no-repeat center;width:40px;height:40px;background-size: auto 100%;border-radius: 20px;float:left"></div><div style="margin-left: 60px;height:50px;line-height:40px;text-align:left;float:clear;overflow:hidden">        <div class="popular-posts-title"><p><a href="/超簡單用python抓取每月營收/" title="超簡單用python抓取每月營收" rel="bookmark">超簡單用python抓取每月營收</a></p></div></div></div><div><div style="margin-right:20px;background: url('/Python-簡單158種技術指標計算/tsmc.png') no-repeat center;width:40px;height:40px;background-size: auto 100%;border-radius: 20px;float:left"></div><div style="margin-left: 60px;height:50px;line-height:40px;text-align:left;float:clear;overflow:hidden">        <div class="popular-posts-title"><p><a href="/Python-簡單158種技術指標計算/" title="Python 簡單158種技術指標計算" rel="bookmark">Python 簡單158種技術指標計算</a></p></div></div></div><div><div style="margin-right:20px;background: url('/Python-簡單用月營收選股！/thumbnail.png') no-repeat center;width:40px;height:40px;background-size: auto 100%;border-radius: 20px;float:left"></div><div style="margin-left: 60px;height:50px;line-height:40px;text-align:left;float:clear;overflow:hidden">        <div class="popular-posts-title"><p><a href="/Python-簡單用月營收選股！/" title="Python-簡單的月營收選股！" rel="bookmark">Python-簡單的月營收選股！</a></p></div></div></div><div><div style="margin-right:20px;background: url('/Python-簡單選股和回測/thumbnail.jpeg') no-repeat center;width:40px;height:40px;background-size: auto 100%;border-radius: 20px;float:left"></div><div style="margin-left: 60px;height:50px;line-height:40px;text-align:left;float:clear;overflow:hidden">        <div class="popular-posts-title"><p><a href="/Python-簡單選股和回測/" title="Python 簡單選股和回測" rel="bookmark">Python 簡單選股和回測</a></p></div></div></div><div><div style="margin-right:20px;background: url('/Python-財報爬蟲-1-綜合損益表/thumbnail.png') no-repeat center;width:40px;height:40px;background-size: auto 100%;border-radius: 20px;float:left"></div><div style="margin-left: 60px;height:50px;line-height:40px;text-align:left;float:clear;overflow:hidden">        <div class="popular-posts-title"><p><a href="/Python-財報爬蟲-1-綜合損益表/" title="Python 財報爬蟲" rel="bookmark">Python 財報爬蟲</a></p></div></div></div></ul>        
            </div>
            
            <hr>
            <p>喜歡我們的文章的話，可以在下方用 email 訂閱，這樣每次有新文章時，就能收到訊息喔～隨時可以取消訂閱，不用擔心我會寄垃圾信，這個是第三方軟體，只有blog更新時才會通知你啦！</p>

<!-- Begin MailChimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
	#mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; width:100%;}
	/* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="https://github.us17.list-manage.com/subscribe/post?u=d8cd009ba8ad9a1188c6e206e&amp;id=a7714d56c6" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
    <div id="mc_embed_signup_scroll" style="margin-bottom: 30px">
	<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_d8cd009ba8ad9a1188c6e206e_a7714d56c6" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="訂閱" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>

<!--End mc_embed_signup-->


            <footer class="article-footer">
            


    <div class="a2a_kit a2a_default_style">
    <a class="a2a_dd" href="https://www.addtoany.com/share" rel="external nofollow noopener noreferrer" target="_blank">Share</a>
    <span class="a2a_divider"></span>
    <a class="a2a_button_facebook"></a>
    <a class="a2a_button_twitter"></a>
    <a class="a2a_button_google_plus"></a>
    <a class="a2a_button_pinterest"></a>
    <a class="a2a_button_tumblr"></a>
</div>
<script type="text/javascript" src="//static.addtoany.com/menu/page.js"></script>
<style>
    .a2a_menu {
        border-radius: 4px;
    }
    .a2a_menu a {
        margin: 2px 0;
        font-size: 14px;
        line-height: 16px;
        border-radius: 4px;
        color: inherit !important;
        font-family: 'Microsoft Yahei';
    }
    #a2apage_dropdown {
        margin: 10px 0;
    }
    .a2a_mini_services {
        padding: 10px;
    }
    a.a2a_i,
    i.a2a_i {
        width: 122px;
        line-height: 16px;
    }
    a.a2a_i .a2a_svg,
    a.a2a_more .a2a_svg {
        width: 16px;
        height: 16px;
        line-height: 16px;
        vertical-align: top;
        background-size: 16px;
    }
    a.a2a_i {
        border: none !important;
    }
    a.a2a_menu_show_more_less {
        margin: 0;
        padding: 10px 0;
        line-height: 16px;
    }
    .a2a_mini_services:after{content:".";display:block;height:0;clear:both;visibility:hidden}
    .a2a_mini_services{*+height:1%;}
</style>


        </footer>
    </div>
</div></article>

    <section id="comments">
    
        
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>

    
    </section>


                        </div>
                    </section>
                    <aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
    <div class="sidebar-top">
        <p>作者的相關連結 :</p>
        <ul class="social-links">
            
                
                <li>
                    <a class="social-tooltip" title="linkedin" href="https://linkedin.com/in/cheng-yu-han-4b845aa2" target="_blank" rel="external nofollow noopener noreferrer">
                        <i class="icon fa fa-linkedin"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="facebook" href="https://www.facebook.com/profile.php?id=100000709225894" target="_blank" rel="external nofollow noopener noreferrer">
                        <i class="icon fa fa-facebook"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="envelope" href="mailto:finlabstaff@gmail.com" target="_blank" rel="external nofollow noopener noreferrer">
                        <i class="icon fa fa-envelope"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="rss" href="/atom.xml" target="_blank">
                        <i class="icon fa fa-rss"></i>
                    </a>
                </li>
                
            
        </ul>
    </div>
    
        
<nav id="article-nav">
    
        <a href="/用數學計算日馳何時崩盤！/" id="article-nav-newer" class="article-nav-link-wrap">
        <strong class="article-nav-caption">下一篇</strong>
        <p class="article-nav-title">
        
            用數學計算日馳何時崩盤！
        
        </p>
        <i class="icon fa fa-chevron-right" id="icon-chevron-right"></i>
    </a>
    
    
        <a href="/投信跟盤法！/" id="article-nav-older" class="article-nav-link-wrap">
        <strong class="article-nav-caption">上一篇</strong>
        <p class="article-nav-title">新年賀禮 ─ 投信跟盤法！</p>
        <i class="icon fa fa-chevron-left" id="icon-chevron-left"></i>
        </a>
    
</nav>

    
    <div class="widgets-container">
        
            
                
    <!--
    <div class="widget-wrap">
        <form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open('https://feedburner.google.com/fb/a/mailverify?uri=Finlab', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true">
            <h3 class="widget-title">訂閱內容</h3>
            <input class="css-input" placeholder="您的email" type="text" name="email" autocomplete="off"/>
            <input type="hidden" value="Finlab" name="uri"/>
            <input type="hidden" name="loc" value="zh_TW"/>
            <input class="btn" type="submit" value="訂閱" />
        </form>
        <p style="color: gray;text-align: center;margin-top:10px">當新文章發佈時，以email通知您！</p>
    </div>-->
    <div class="widget-wrap">
        <h3 class="widget-title">最新文章</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/用深度學習幫你解析K線圖！/" class="thumbnail">
    
    
        <span style="background-image:url(/用深度學習幫你解析K線圖！/K-trends.jpg)" alt="用深度學習幫你解析K線圖！" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/AI看股票/">AI看股票</a></p>
                            <p class="item-title"><a href="/用深度學習幫你解析K線圖！/" class="title">用深度學習幫你解析K線圖！</a></p>
                            <p class="item-date"><time datetime="2018-01-23T19:50:05.000Z" itemprop="datePublished">2018-01-23</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/Python-簡單用月營收選股！/" class="thumbnail">
    
    
        <span style="background-image:url(/Python-簡單用月營收選股！/thumbnail.png)" alt="Python-簡單的月營收選股！" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/財經Python教學/">財經Python教學</a></p>
                            <p class="item-title"><a href="/Python-簡單用月營收選股！/" class="title">Python-簡單的月營收選股！</a></p>
                            <p class="item-date"><time datetime="2018-01-22T14:10:47.000Z" itemprop="datePublished">2018-01-22</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/三種月營收進階看法/" class="thumbnail">
    
    
        <span style="background-image:url(/三種月營收進階看法/thumbnail.png)" alt="三種看月營收的進階方法！" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/指標分析/">指標分析</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/指標分析/基本面/">基本面</a></p>
                            <p class="item-title"><a href="/三種月營收進階看法/" class="title">三種看月營收的進階方法！</a></p>
                            <p class="item-date"><time datetime="2018-01-17T23:27:48.000Z" itemprop="datePublished">2018-01-18</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/用數學計算日馳何時崩盤！/" class="thumbnail">
    
    
        <span style="background-image:url(/用數學計算日馳何時崩盤！/thumbnail.png)" alt="用數學計算日馳何時崩盤！" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/財經Python教學/">財經Python教學</a></p>
                            <p class="item-title"><a href="/用數學計算日馳何時崩盤！/" class="title">用數學計算日馳何時崩盤！</a></p>
                            <p class="item-date"><time datetime="2018-01-10T15:18:47.000Z" itemprop="datePublished">2018-01-10</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/用python獲取持股損益表/" class="thumbnail">
    
    
        <span style="background-image:url(/用python獲取持股損益表/thumbnail.jpeg)" alt="自動下單（1）用Python爬取交易記錄" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/財經Python教學/">財經Python教學</a></p>
                            <p class="item-title"><a href="/用python獲取持股損益表/" class="title">自動下單（1）用Python爬取交易記錄</a></p>
                            <p class="item-date"><time datetime="2018-01-08T14:07:16.000Z" itemprop="datePublished">2018-01-08</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">分類</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AI看股票/">AI看股票</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/大盤漲跌/">大盤漲跌</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/指標分析/">指標分析</a><span class="category-list-count">19</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/指標分析/基本面/">基本面</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/指標分析/技術面/">技術面</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/指標分析/籌碼面/">籌碼面</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/財報狗分析/">財報狗分析</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/財經Python教學/">財經Python教學</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/選股策略/">選股策略</a><span class="category-list-count">5</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">記錄</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a><span class="archive-list-count">18</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a><span class="archive-list-count">12</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-float">
        <h3 class="widget-title">標籤雲</h3>
        <div class="widget tagcloud">
            <a href="/tags/Candlesticks/" style="font-size: 10px;">Candlesticks</a> <a href="/tags/Deep-Learning/" style="font-size: 10px;">Deep-Learning</a> <a href="/tags/EPS/" style="font-size: 10px;">EPS</a> <a href="/tags/KD/" style="font-size: 10px;">KD</a> <a href="/tags/K棒/" style="font-size: 10px;">K棒</a> <a href="/tags/K線圖/" style="font-size: 10px;">K線圖</a> <a href="/tags/LSTM/" style="font-size: 10px;">LSTM</a> <a href="/tags/Machine-Learning/" style="font-size: 12.22px;">Machine Learning</a> <a href="/tags/PEG/" style="font-size: 10px;">PEG</a> <a href="/tags/ROE/" style="font-size: 11.11px;">ROE</a> <a href="/tags/RSI/" style="font-size: 10px;">RSI</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/一行/" style="font-size: 10px;">一行</a> <a href="/tags/價值股/" style="font-size: 10px;">價值股</a> <a href="/tags/入門教學/" style="font-size: 13.33px;">入門教學</a> <a href="/tags/分佈圖/" style="font-size: 10px;">分佈圖</a> <a href="/tags/型態學/" style="font-size: 10px;">型態學</a> <a href="/tags/外資/" style="font-size: 10px;">外資</a> <a href="/tags/大盤/" style="font-size: 13.33px;">大盤</a> <a href="/tags/如何買股票/" style="font-size: 18.89px;">如何買股票</a> <a href="/tags/市值營收比/" style="font-size: 11.11px;">市值營收比</a> <a href="/tags/投信/" style="font-size: 10px;">投信</a> <a href="/tags/指標/" style="font-size: 12.22px;">指標</a> <a href="/tags/月營收/" style="font-size: 12.22px;">月營收</a> <a href="/tags/本益成長比/" style="font-size: 10px;">本益成長比</a> <a href="/tags/本益比/" style="font-size: 14.44px;">本益比</a> <a href="/tags/杜邦分析/" style="font-size: 14.44px;">杜邦分析</a> <a href="/tags/機器學習/" style="font-size: 12.22px;">機器學習</a> <a href="/tags/歷史回測/" style="font-size: 18.89px;">歷史回測</a> <a href="/tags/每股盈餘/" style="font-size: 10px;">每股盈餘</a> <a href="/tags/深度學習/" style="font-size: 10px;">深度學習</a> <a href="/tags/爬蟲/" style="font-size: 10px;">爬蟲</a> <a href="/tags/生活/" style="font-size: 11.11px;">生活</a> <a href="/tags/程式設計/" style="font-size: 16.67px;">程式設計</a> <a href="/tags/策略狗/" style="font-size: 12.22px;">策略狗</a> <a href="/tags/簡易策略/" style="font-size: 14.44px;">簡易策略</a> <a href="/tags/統計/" style="font-size: 10px;">統計</a> <a href="/tags/總資產轉換率/" style="font-size: 10px;">總資產轉換率</a> <a href="/tags/股價淨值比/" style="font-size: 14.44px;">股價淨值比</a> <a href="/tags/股票分析/" style="font-size: 10px;">股票分析</a> <a href="/tags/自由現金報酬率/" style="font-size: 12.22px;">自由現金報酬率</a> <a href="/tags/選股/" style="font-size: 15.56px;">選股</a> <a href="/tags/選股策略/" style="font-size: 17.78px;">選股策略</a> <a href="/tags/量化投資/" style="font-size: 10px;">量化投資</a>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">連結</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="https://stasistw.blogspot.fr" rel="external nofollow noopener noreferrer" target="_blank">市場求生手冊</a>
                    </li>
                
                    <li>
                        <a href="http://investarter.blogspot.fr" rel="external nofollow noopener noreferrer" target="_blank">阿升理財筆記</a>
                    </li>
                
                    <li>
                        <a href="http://hexo.io" rel="external nofollow noopener noreferrer" target="_blank">Hexo</a>
                    </li>
                
            </ul>
        </div>
    </div>


            
        
    </div>
</aside>
                </div>
            </div>
        </div>
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" class="logo"></a>
                </h1>
                <p>&copy; 2018 koreal6803</p>
                <p>Powered by <a href="//hexo.io/" target="_blank">Hexo</a>. Theme by <a href="//github.com/ppoffice" target="_blank">PPOffice</a></p>
                <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
                <span id="busuanzi_container_site_pv">
                    本站總訪問量<span id="busuanzi_value_site_pv"></span>次
                </span>
            </div>
        </div>
    </div>
</footer>
        
    
    <script>
    var disqus_shortname = 'koreal6803';
    
    
    var disqus_url = 'https://www.finlab.tw/用python獲取持股損益表/';
    
    (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>




    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    
        <!-- Edit here -->
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
        </script>
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>

